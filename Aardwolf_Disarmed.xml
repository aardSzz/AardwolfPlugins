<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Friday, July 19, 2024, 9:57 AM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "Aardwolf_Disarmed" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Aardwolf_Disarmed"
   author="Szzilleriel"
   id="f65e120290f78dd63d65433f"
   language="Lua"
   purpose="Don't get disarmed! Don't bother with your own triggers!"
   save_state="y"
   date_written="2024-07-19 09:55:13"
   requires="4.97"
   version="1.03"
   >
<description trim="y">
<![CDATA[
help disarm

It will display the normal disarm help file as well.
]]>
</description>

</plugin>


<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   expand_variables="y"
   match="^(.*) DISARMS you and you struggle not to drop your weapon\!$"
   regexp="y"
   script="Aardwolf_Disarmed_Wield"
   send_to="12"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   match="^(.+) DISARMS you and sends your (.+) flying\!$"
   regexp="y"
   script="Aardwolf_Disarmed_GetWield"
   send_to="12"
   sequence="100"
  >
  </trigger>
  <trigger
   enabled="y"
   match="^(.*) DISARMS you but your weapon's curse prevents it from falling.$"
   regexp="y"
   script="Aardwolf_Disarmed_Wield"
   send_to="12"
   sequence="100"
  >
  </trigger>
</triggers>

<!--  Aliases  -->

<aliases>
  <alias
   script="Aardwolf_Disarmed"
   match="help disarm"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  </alias>
  <alias
   script="Aardwolf_Disarmed_WeaponSet"
   match="^weaponset (?<keyword>.*)$"
   enabled="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  </alias>
  <alias
   script="Aardwolf_Disarmed_WeaponDisplay"
   match="^weaponset$"
   enabled="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  </alias>
</aliases>

<!--  Script  -->


<script>
<![CDATA[
require "serialize"

local options = {
	weaponset = {
		["WeaponKeyword"] = "dagger",
    }
}

function Aardwolf_Disarmed(name, line, wildcards)
    Send("help disarm")
    Aardwolf_Disarmed_PrintHelp()
end

function Aardwolf_Disarmed_PrintHelp()
    DoAfterSpecial(1, 'Note (" ")', 12) 
    DoAfterSpecial(1, 'Note ("Aardwolf_Disarmed by Szzilleriel")', 12)
    DoAfterSpecial(1, 'Note ("---------------------------------------")', 12)
    DoAfterSpecial(1, 'Note ("weaponset [keyword|keywords here]")', 12)
    DoAfterSpecial(1, 'Note (" ")', 12)
    DoAfterSpecial(1, 'Note ("Examples:")', 12)
    DoAfterSpecial(1, 'Note ("weaponset dagger")', 12)
    DoAfterSpecial(1, 'Note ("weaponset black axe")', 12)
    DoAfterSpecial(1, 'Note (" ")', 12)
    DoAfterSpecial(1, 'Note ("weaponset with no arguments will display current setting.")', 12)
end

function Aardwolf_Disarmed_Wield(name, line, wildcards)
    Send("wield " .. options.weaponset.WeaponKeyword)
    ColourNote("white", "red", "[Aardwolf_Disarmed]: We were DISARMED to inventory. Wielding weapon.")
end

function Aardwolf_Disarmed_GetWield(name, line, wildcards)
    Send("get " .. options.weaponset.WeaponKeyword)
    Send("wield " .. options.weaponset.WeaponKeyword)
    ColourNote("white", "red", "[Aardwolf_Disarmed]: We were DISARMED to ground. Getting, then wielding weapon.")
end

function Aardwolf_Disarmed_WeaponDisplay(name, line, wildcards)
    Note("Current Weapon Keyword(s) are: " .. options.weaponset["WeaponKeyword"])
end

function Aardwolf_Disarmed_WeaponSet(name, line, wildcards)
    options.weaponset.WeaponKeyword = wildcards.keyword
    Aardwolf_Disarmed_Save()
    Note("Weapon Keyword(s) set to: " .. wildcards.keyword)
end

function Aardwolf_Disarmed_Save()
    SetVariable("Aardwolf_Disarmed", serialize.save_simple(options))
    SaveState()
end

function OnPluginEnable()
    if GetVariable("Aardwolf_Disarmed") then
        options = assert(loadstring("return " .. GetVariable("Aardwolf_Disarmed")))()
    end
    Aardwolf_Disarmed_PrintHelp()
end

function OnPluginInstall()
    if GetVariable("Aardwolf_Disarmed") then
        options = assert(loadstring("return " .. GetVariable("Aardwolf_Disarmed")))()
    end
    ColourNote("white", "", "[Aardwolf_Disarmed] by Szilleriel - Installed v" .. GetPluginInfo(GetPluginID(), 19))
    Aardwolf_Disarmed_PrintHelp()
end

function OnPluginDisable()
    Aardwolf_Disarmed_Save()
end

function OnPluginClose()
    Aardwolf_Disarmed_Save()
end
]]>
</script>


<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="Aardwolf_Disarmed:help"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
function OnHelp ()
  world.Note (world.GetPluginInfo (world.GetPluginID (), 3))
end
]]>
</script> 

</muclient>
